# 토큰과 비용 이해하기

> **이 문서의 목표:** 토큰이 뭔지, 내 잔여량은 어떻게 확인하는지, 어떻게 아끼는지

---

## 1. 토큰이란?

### 자동차 비유

```
토큰 = 연료 (기름)
대화 = 주행
CLAUDE.md = 매번 시동 걸 때 소모되는 기본 연료
큰 파일 읽기 = 급가속 (연료 많이 씀)
간결한 요청 = 경제 운전
```

### 기술적 의미

- **토큰** = AI가 처리하는 텍스트의 최소 단위
- 한국어 1글자 ≈ 2~3 토큰 / 영어 1단어 ≈ 1~2 토큰
- **입력 토큰**: 당신의 요청 + CLAUDE.md + 읽은 파일들 + 대화 히스토리
- **출력 토큰**: Claude의 응답 + 생성한 코드

### 토큰 소모 구조

```
세션 시작
  └─ CLAUDE.md 로드 (매번 소모) ─── 약 3,000~5,000 토큰
  └─ 당신의 요청 ──────────────── 수백 토큰
  └─ 파일 읽기 ────────────────── 파일 크기에 비례
  └─ Claude 응답 + 코드 생성 ──── 작업량에 비례
  └─ 대화 히스토리 누적 ────────── 세션 길어질수록 증가
```

---

## 2. 내 잔여 토큰 확인 방법

### Claude Code CLI에서

Claude Code 터미널에서 사용량을 확인할 수 있습니다:
- `/cost` 명령어로 현재 세션의 토큰 사용량 확인

### 구독 플랜별 한도

| 플랜 | 월 비용 | Claude Code 사용 | 특징 |
|------|--------|-----------------|------|
| **Pro** | $20/월 | 포함 (제한적) | 일반 사용 |
| **Max (5x)** | $100/월 | 포함 (5배) | 헤비 사용자 |
| **Max (20x)** | $200/월 | 포함 (20배) | 전문 개발자 |
| **API** | 종량제 | 토큰당 과금 | 자유도 최대 |

### 한도 도달 시

- Pro/Max: 한도 도달 시 속도 제한(rate limit)이 걸림
- 완전히 차단되는 것이 아니라 **응답 속도가 느려짐**
- 매월 결제일 기준으로 리셋

### 확인 방법

1. **claude.ai** 웹사이트 → Settings → Usage 에서 사용량 확인
2. Claude Code CLI에서 `/cost` 로 현재 세션 비용 확인

---

## 3. 토큰 절약 전략

### 즉시 실천 가능한 것들

| 전략 | 절약 효과 | 난이도 |
|------|----------|--------|
| 구체적으로 요청 (1회로 끝내기) | 높음 | 쉬움 |
| 파일 경로 직접 제시 | 중간 | 쉬움 |
| 범위 한정 ("이 메서드만") | 높음 | 쉬움 |
| 세션 적절히 끊기 | 중간 | 쉬움 |
| CLAUDE.md 간결하게 유지 | 중간 | 보통 |

### 고급 절약 전략

**1) Subagent 위임 활용**

Subagent는 별도의 컨텍스트에서 실행되므로, 메인 대화의 토큰을 아낄 수 있습니다.
→ 큰 탐색 작업은 Subagent에게 맡기고, 결과 요약만 받기

**2) 컨텍스트 엔지니어링 (`/ce`)**

에이전트에게 최소한의 문서만 주입하는 기술입니다.
→ MA가 자동으로 하지만, 이 원리를 알면 더 효율적으로 요청 가능

**3) 세션 분리**

```
✅ 세션 1: "회원가입 API 만들어줘" → 완료
✅ 세션 2: "로그인 API 만들어줘" → 완료

❌ 하나의 세션에서 5개 기능을 연속으로
   → 후반부에는 컨텍스트가 커져서 비효율적
```

---

## 4. "연비 좋은 운전" 요약

```
🟢 연비 좋은 요청:
   "MemberService.java의 signup 메서드에서
    이메일 중복 체크 로직을 Optional.ifPresent 패턴으로 바꿔줘"

🔴 연비 나쁜 요청:
   "서비스 파일 좀 봐봐"
   "뭔가 이상한데 찾아줘"
   "전체 코드 다 리뷰해줘"
```

### 핵심 공식

```
효율 = (구체적 요청) + (경로 제시) + (범위 한정) + (적절한 세션 관리)
```

---

## 5. 자주 묻는 질문

### Q: 토큰이 다 떨어지면 어떻게 되나?

**A:** 완전히 차단되지는 않습니다. 속도 제한이 걸려서 응답이 느려집니다.
급한 작업이 있다면 플랜 업그레이드를 고려하세요.

### Q: 멀티에이전트가 토큰을 더 많이 쓰나?

**A:** 각 Subagent 호출은 추가 토큰을 소모합니다. 하지만:
- Subagent는 필요한 최소 컨텍스트만 받음
- 메인 대화의 컨텍스트 오염을 방지
- 전체적으로는 더 효율적일 수 있음

### Q: CLAUDE.md가 길면 비용이 더 드나?

**A:** 네. CLAUDE.md는 매 요청마다 입력 토큰으로 소모됩니다.
핵심 규칙만 간결하게 유지하고, 상세 내용은 별도 문서로 분리하세요.

### Q: 이전 대화 내용도 토큰을 소모하나?

**A:** 네. 대화가 길어질수록 히스토리가 쌓여 토큰 소모가 증가합니다.
Claude Code는 자동으로 오래된 대화를 압축하지만, 세션을 적절히 끊는 것이 좋습니다.

---